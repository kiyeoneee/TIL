# 1. 카프카 훑어보기

## 메시지 발행과 구독하기

* 발행자 : 메세지를 구분해서 발행/구독 시스템에 전송
* 구독자 : 특정 부류의 메세지를 구독
* 브로커 : 발행된 메시지를 저장하고 중계

<br>

## 카프카 살펴보기

'분산 커밋 로그' 또는 '분산 스트리밍 플랫폼' 이라고 함  

### 메시지와 배치

카프카는 여러 개의 메시지를 모아 배치 형태로 파티션에 수록

* 네트워크로부터 매번 각 메시지를 받아서 처리하는 데 따른 부담을 줄일 수 있음
* 배치의 크기가 클수록 단위 시간당 처리될 수 있는 메시지는 많아지지만, 각 메시지의 전송 시간은 더 길어짐
  -> 대기 시간과 처리량 간의 트레이드 오프가 생길 수 있음

### 스키마

메세지 형식으로 JSON, XML을 쓸 수 있지만, 버전간의 호환성 등을 위해 주로 아파치 Avro를 선호
일관된 데이터 형식이 중요
구버전과 신버전의 데이터 형식을 병행 처리하기 위해 **구독 애플리케이션**을 먼저 업데이트 한 후 **발행 애플리케이션**을 업데이트 해야 함
또는 스키마를 공유 레포지토리에 저장해 애플리케이션 변경없이도 사용 가능

### 브로커와 클러스터

**브로커** : 카프카 서버 
프로듀서로부터 메세지 수신, 오프셋 저장, 메세지 저장, 컨슈머에 메세지 발신

카프카 클러스터 중 하나의 브로커는 **클러스터 컨트롤러**가 됨
같은 파티션이 여러 브로커에 복제될 수 있지만 한 브로커만 파티션을 소유하는 **파티션 리더**가 됨



